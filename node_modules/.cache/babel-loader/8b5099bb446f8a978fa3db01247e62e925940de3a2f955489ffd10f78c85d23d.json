{"ast":null,"code":"import axios from \"axios\";\nimport createCache from \"../utils/cache\";\nconst BASE_URL = \"https://projetdelamort.onrender.com/\";\nexport const api = axios.create({\n  baseURL: BASE_URL,\n  withCredentials: true,\n  timeout: 10000\n});\nconst cache = createCache(500, 300000);\napi.interceptors.request.use(async config => {\n  var _config$url, _config$url2, _config$url3, _config$url4, _config$url5, _config$url6;\n  if (!navigator.onLine) {\n    return Promise.reject({\n      response: {\n        data: {\n          message: \"Pas de connexion Internet\"\n        }\n      }\n    });\n  }\n  const accessToken = localStorage.getItem(\"accessToken\");\n  if (accessToken && !((_config$url = config.url) !== null && _config$url !== void 0 && _config$url.includes(\"/login\")) && !((_config$url2 = config.url) !== null && _config$url2 !== void 0 && _config$url2.includes(\"/register\")) && !((_config$url3 = config.url) !== null && _config$url3 !== void 0 && _config$url3.includes(\"/forgot-password\")) && !((_config$url4 = config.url) !== null && _config$url4 !== void 0 && _config$url4.includes(\"/verify-reset-code\")) && !((_config$url5 = config.url) !== null && _config$url5 !== void 0 && _config$url5.includes(\"/logout\")) && !((_config$url6 = config.url) !== null && _config$url6 !== void 0 && _config$url6.includes(\"/refresh\"))) {\n    config.headers[\"Authorization\"] = `Bearer ${accessToken}`;\n    // console.log(accessToken);\n  }\n  const paramsString = config.params ? new URLSearchParams(config.params).toString() : \"\";\n  const bodyString = config.data ? JSON.stringify(config.data) : \"\";\n  const cacheKey = `${config.url}?${paramsString}&body=${bodyString}`;\n  const cachedData = cache.get(cacheKey);\n  if (cachedData) {\n    console.log(\"cache hit : \", cachedData);\n    return Promise.reject({\n      isCached: true,\n      data: cachedData\n    });\n  }\n  // console.log(\"=== INTERCEPTOR ===\");\n  // console.log(\"AccessToken =\", accessToken);\n  // console.log(\"URL =\", config.url);\n  // console.log(\"Headers avant =\", config.headers);\n\n  return config;\n}, error => Promise.reject(error));","map":{"version":3,"names":["axios","createCache","BASE_URL","api","create","baseURL","withCredentials","timeout","cache","interceptors","request","use","config","_config$url","_config$url2","_config$url3","_config$url4","_config$url5","_config$url6","navigator","onLine","Promise","reject","response","data","message","accessToken","localStorage","getItem","url","includes","headers","paramsString","params","URLSearchParams","toString","bodyString","JSON","stringify","cacheKey","cachedData","get","console","log","isCached","error"],"sources":["/home/hugo/Documents/4A/cyber/front_url_parser/src/services/api.ts"],"sourcesContent":["import axios from \"axios\";\nimport createCache from \"../utils/cache\";\nconst BASE_URL = \"https://projetdelamort.onrender.com/\";\n\nexport const api = axios.create({\n  baseURL: BASE_URL,\n  withCredentials: true,\n  timeout: 10000,\n});\n\nconst cache = createCache(500, 300000);\n\n api.interceptors.request.use(\n  async (config) => {\n    if (!navigator.onLine) {\n  return Promise.reject({\n    response: { data: { message: \"Pas de connexion Internet\" } },\n  });\n}\n\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n    if (\n      accessToken &&\n      !config.url?.includes(\"/login\") &&\n      !config.url?.includes(\"/register\") &&\n      !config.url?.includes(\"/forgot-password\") &&\n      !config.url?.includes(\"/verify-reset-code\") &&\n      !config.url?.includes(\"/logout\") &&\n      !config.url?.includes(\"/refresh\")\n    ) {\n      config.headers[\"Authorization\"] = `Bearer ${accessToken}`;\n      // console.log(accessToken);\n    }\n\n    const paramsString = config.params\n      ? new URLSearchParams(config.params).toString()\n      : \"\";\n    const bodyString = config.data ? JSON.stringify(config.data) : \"\";\n    const cacheKey = `${config.url}?${paramsString}&body=${bodyString}`;\n\n    const cachedData = cache.get(cacheKey);\n    if (cachedData) {\n      console.log(\"cache hit : \", cachedData);\n      return Promise.reject({ isCached: true, data: cachedData });\n    }\n    // console.log(\"=== INTERCEPTOR ===\");\n    // console.log(\"AccessToken =\", accessToken);\n    // console.log(\"URL =\", config.url);\n    // console.log(\"Headers avant =\", config.headers);\n\n    return config;\n  },\n  (error) => Promise.reject(error)\n);"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,WAAW,MAAM,gBAAgB;AACxC,MAAMC,QAAQ,GAAG,sCAAsC;AAEvD,OAAO,MAAMC,GAAG,GAAGH,KAAK,CAACI,MAAM,CAAC;EAC9BC,OAAO,EAAEH,QAAQ;EACjBI,eAAe,EAAE,IAAI;EACrBC,OAAO,EAAE;AACX,CAAC,CAAC;AAEF,MAAMC,KAAK,GAAGP,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC;AAErCE,GAAG,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAC3B,MAAOC,MAAM,IAAK;EAAA,IAAAC,WAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA,EAAAC,YAAA;EAChB,IAAI,CAACC,SAAS,CAACC,MAAM,EAAE;IACzB,OAAOC,OAAO,CAACC,MAAM,CAAC;MACpBC,QAAQ,EAAE;QAAEC,IAAI,EAAE;UAAEC,OAAO,EAAE;QAA4B;MAAE;IAC7D,CAAC,CAAC;EACJ;EAGI,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;EACvD,IACEF,WAAW,IACX,GAAAb,WAAA,GAACD,MAAM,CAACiB,GAAG,cAAAhB,WAAA,eAAVA,WAAA,CAAYiB,QAAQ,CAAC,QAAQ,CAAC,KAC/B,GAAAhB,YAAA,GAACF,MAAM,CAACiB,GAAG,cAAAf,YAAA,eAAVA,YAAA,CAAYgB,QAAQ,CAAC,WAAW,CAAC,KAClC,GAAAf,YAAA,GAACH,MAAM,CAACiB,GAAG,cAAAd,YAAA,eAAVA,YAAA,CAAYe,QAAQ,CAAC,kBAAkB,CAAC,KACzC,GAAAd,YAAA,GAACJ,MAAM,CAACiB,GAAG,cAAAb,YAAA,eAAVA,YAAA,CAAYc,QAAQ,CAAC,oBAAoB,CAAC,KAC3C,GAAAb,YAAA,GAACL,MAAM,CAACiB,GAAG,cAAAZ,YAAA,eAAVA,YAAA,CAAYa,QAAQ,CAAC,SAAS,CAAC,KAChC,GAAAZ,YAAA,GAACN,MAAM,CAACiB,GAAG,cAAAX,YAAA,eAAVA,YAAA,CAAYY,QAAQ,CAAC,UAAU,CAAC,GACjC;IACAlB,MAAM,CAACmB,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUL,WAAW,EAAE;IACzD;EACF;EAEA,MAAMM,YAAY,GAAGpB,MAAM,CAACqB,MAAM,GAC9B,IAAIC,eAAe,CAACtB,MAAM,CAACqB,MAAM,CAAC,CAACE,QAAQ,CAAC,CAAC,GAC7C,EAAE;EACN,MAAMC,UAAU,GAAGxB,MAAM,CAACY,IAAI,GAAGa,IAAI,CAACC,SAAS,CAAC1B,MAAM,CAACY,IAAI,CAAC,GAAG,EAAE;EACjE,MAAMe,QAAQ,GAAG,GAAG3B,MAAM,CAACiB,GAAG,IAAIG,YAAY,SAASI,UAAU,EAAE;EAEnE,MAAMI,UAAU,GAAGhC,KAAK,CAACiC,GAAG,CAACF,QAAQ,CAAC;EACtC,IAAIC,UAAU,EAAE;IACdE,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEH,UAAU,CAAC;IACvC,OAAOnB,OAAO,CAACC,MAAM,CAAC;MAAEsB,QAAQ,EAAE,IAAI;MAAEpB,IAAI,EAAEgB;IAAW,CAAC,CAAC;EAC7D;EACA;EACA;EACA;EACA;;EAEA,OAAO5B,MAAM;AACf,CAAC,EACAiC,KAAK,IAAKxB,OAAO,CAACC,MAAM,CAACuB,KAAK,CACjC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}