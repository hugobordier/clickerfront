{"ast":null,"code":"import axios from\"axios\";import createCache from\"../utils/cache\";const BASE_URL=\"https://projetdelamort.onrender.com/\";export const api=axios.create({baseURL:BASE_URL,withCredentials:true,timeout:10000});const cache=createCache(500,300000);api.interceptors.request.use(async config=>{var _config$url,_config$url2,_config$url3,_config$url4,_config$url5,_config$url6;if(!navigator.onLine){return Promise.reject({response:{data:{message:\"Pas de connexion Internet\"}}});}const accessToken=localStorage.getItem(\"accessToken\");if(accessToken&&!((_config$url=config.url)!==null&&_config$url!==void 0&&_config$url.includes(\"/login\"))&&!((_config$url2=config.url)!==null&&_config$url2!==void 0&&_config$url2.includes(\"/register\"))&&!((_config$url3=config.url)!==null&&_config$url3!==void 0&&_config$url3.includes(\"/forgot-password\"))&&!((_config$url4=config.url)!==null&&_config$url4!==void 0&&_config$url4.includes(\"/verify-reset-code\"))&&!((_config$url5=config.url)!==null&&_config$url5!==void 0&&_config$url5.includes(\"/logout\"))&&!((_config$url6=config.url)!==null&&_config$url6!==void 0&&_config$url6.includes(\"/refresh\"))){config.headers[\"Authorization\"]=\"Bearer \".concat(accessToken);// console.log(accessToken);\n}const paramsString=config.params?new URLSearchParams(config.params).toString():\"\";const bodyString=config.data?JSON.stringify(config.data):\"\";const cacheKey=\"\".concat(config.url,\"?\").concat(paramsString,\"&body=\").concat(bodyString);const cachedData=cache.get(cacheKey);if(cachedData){console.log(\"cache hit : \",cachedData);return Promise.reject({isCached:true,data:cachedData});}// console.log(\"=== INTERCEPTOR ===\");\n// console.log(\"AccessToken =\", accessToken);\n// console.log(\"URL =\", config.url);\n// console.log(\"Headers avant =\", config.headers);\nreturn config;},error=>Promise.reject(error));","map":{"version":3,"names":["axios","createCache","BASE_URL","api","create","baseURL","withCredentials","timeout","cache","interceptors","request","use","config","_config$url","_config$url2","_config$url3","_config$url4","_config$url5","_config$url6","navigator","onLine","Promise","reject","response","data","message","accessToken","localStorage","getItem","url","includes","headers","concat","paramsString","params","URLSearchParams","toString","bodyString","JSON","stringify","cacheKey","cachedData","get","console","log","isCached","error"],"sources":["/home/hugo/Documents/4A/cyber/front_url_parser/src/services/api.ts"],"sourcesContent":["import axios from \"axios\";\nimport createCache from \"../utils/cache\";\nconst BASE_URL = \"https://projetdelamort.onrender.com/\";\n\nexport const api = axios.create({\n  baseURL: BASE_URL,\n  withCredentials: true,\n  timeout: 10000,\n});\n\nconst cache = createCache(500, 300000);\n\n api.interceptors.request.use(\n  async (config) => {\n    if (!navigator.onLine) {\n  return Promise.reject({\n    response: { data: { message: \"Pas de connexion Internet\" } },\n  });\n}\n\n\n    const accessToken = localStorage.getItem(\"accessToken\");\n    if (\n      accessToken &&\n      !config.url?.includes(\"/login\") &&\n      !config.url?.includes(\"/register\") &&\n      !config.url?.includes(\"/forgot-password\") &&\n      !config.url?.includes(\"/verify-reset-code\") &&\n      !config.url?.includes(\"/logout\") &&\n      !config.url?.includes(\"/refresh\")\n    ) {\n      config.headers[\"Authorization\"] = `Bearer ${accessToken}`;\n      // console.log(accessToken);\n    }\n\n    const paramsString = config.params\n      ? new URLSearchParams(config.params).toString()\n      : \"\";\n    const bodyString = config.data ? JSON.stringify(config.data) : \"\";\n    const cacheKey = `${config.url}?${paramsString}&body=${bodyString}`;\n\n    const cachedData = cache.get(cacheKey);\n    if (cachedData) {\n      console.log(\"cache hit : \", cachedData);\n      return Promise.reject({ isCached: true, data: cachedData });\n    }\n    // console.log(\"=== INTERCEPTOR ===\");\n    // console.log(\"AccessToken =\", accessToken);\n    // console.log(\"URL =\", config.url);\n    // console.log(\"Headers avant =\", config.headers);\n\n    return config;\n  },\n  (error) => Promise.reject(error)\n);"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,WAAW,KAAM,gBAAgB,CACxC,KAAM,CAAAC,QAAQ,CAAG,sCAAsC,CAEvD,MAAO,MAAM,CAAAC,GAAG,CAAGH,KAAK,CAACI,MAAM,CAAC,CAC9BC,OAAO,CAAEH,QAAQ,CACjBI,eAAe,CAAE,IAAI,CACrBC,OAAO,CAAE,KACX,CAAC,CAAC,CAEF,KAAM,CAAAC,KAAK,CAAGP,WAAW,CAAC,GAAG,CAAE,MAAM,CAAC,CAErCE,GAAG,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAC3B,KAAO,CAAAC,MAAM,EAAK,KAAAC,WAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,YAAA,CAAAC,YAAA,CAChB,GAAI,CAACC,SAAS,CAACC,MAAM,CAAE,CACzB,MAAO,CAAAC,OAAO,CAACC,MAAM,CAAC,CACpBC,QAAQ,CAAE,CAAEC,IAAI,CAAE,CAAEC,OAAO,CAAE,2BAA4B,CAAE,CAC7D,CAAC,CAAC,CACJ,CAGI,KAAM,CAAAC,WAAW,CAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CACvD,GACEF,WAAW,EACX,GAAAb,WAAA,CAACD,MAAM,CAACiB,GAAG,UAAAhB,WAAA,WAAVA,WAAA,CAAYiB,QAAQ,CAAC,QAAQ,CAAC,GAC/B,GAAAhB,YAAA,CAACF,MAAM,CAACiB,GAAG,UAAAf,YAAA,WAAVA,YAAA,CAAYgB,QAAQ,CAAC,WAAW,CAAC,GAClC,GAAAf,YAAA,CAACH,MAAM,CAACiB,GAAG,UAAAd,YAAA,WAAVA,YAAA,CAAYe,QAAQ,CAAC,kBAAkB,CAAC,GACzC,GAAAd,YAAA,CAACJ,MAAM,CAACiB,GAAG,UAAAb,YAAA,WAAVA,YAAA,CAAYc,QAAQ,CAAC,oBAAoB,CAAC,GAC3C,GAAAb,YAAA,CAACL,MAAM,CAACiB,GAAG,UAAAZ,YAAA,WAAVA,YAAA,CAAYa,QAAQ,CAAC,SAAS,CAAC,GAChC,GAAAZ,YAAA,CAACN,MAAM,CAACiB,GAAG,UAAAX,YAAA,WAAVA,YAAA,CAAYY,QAAQ,CAAC,UAAU,CAAC,EACjC,CACAlB,MAAM,CAACmB,OAAO,CAAC,eAAe,CAAC,WAAAC,MAAA,CAAaN,WAAW,CAAE,CACzD;AACF,CAEA,KAAM,CAAAO,YAAY,CAAGrB,MAAM,CAACsB,MAAM,CAC9B,GAAI,CAAAC,eAAe,CAACvB,MAAM,CAACsB,MAAM,CAAC,CAACE,QAAQ,CAAC,CAAC,CAC7C,EAAE,CACN,KAAM,CAAAC,UAAU,CAAGzB,MAAM,CAACY,IAAI,CAAGc,IAAI,CAACC,SAAS,CAAC3B,MAAM,CAACY,IAAI,CAAC,CAAG,EAAE,CACjE,KAAM,CAAAgB,QAAQ,IAAAR,MAAA,CAAMpB,MAAM,CAACiB,GAAG,MAAAG,MAAA,CAAIC,YAAY,WAAAD,MAAA,CAASK,UAAU,CAAE,CAEnE,KAAM,CAAAI,UAAU,CAAGjC,KAAK,CAACkC,GAAG,CAACF,QAAQ,CAAC,CACtC,GAAIC,UAAU,CAAE,CACdE,OAAO,CAACC,GAAG,CAAC,cAAc,CAAEH,UAAU,CAAC,CACvC,MAAO,CAAApB,OAAO,CAACC,MAAM,CAAC,CAAEuB,QAAQ,CAAE,IAAI,CAAErB,IAAI,CAAEiB,UAAW,CAAC,CAAC,CAC7D,CACA;AACA;AACA;AACA;AAEA,MAAO,CAAA7B,MAAM,CACf,CAAC,CACAkC,KAAK,EAAKzB,OAAO,CAACC,MAAM,CAACwB,KAAK,CACjC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}