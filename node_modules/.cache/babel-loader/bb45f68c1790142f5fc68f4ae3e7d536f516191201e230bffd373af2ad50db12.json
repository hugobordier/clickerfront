{"ast":null,"code":"export async function calculateProofOfWork(challengeId, difficulty = 4) {\n  const prefix = '0'.repeat(difficulty);\n  const encoder = new TextEncoder();\n  for (let nonce = 0; nonce < Number.MAX_SAFE_INTEGER; nonce++) {\n    const data = encoder.encode(`${challengeId}:${nonce}`);\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n    if (hashHex.startsWith(prefix)) {\n      return nonce.toString();\n    }\n  }\n  throw new Error(\"Proof of Work not found.\");\n}","map":{"version":3,"names":["calculateProofOfWork","challengeId","difficulty","prefix","repeat","encoder","TextEncoder","nonce","Number","MAX_SAFE_INTEGER","data","encode","hashBuffer","crypto","subtle","digest","hashArray","Array","from","Uint8Array","hashHex","map","b","toString","padStart","join","startsWith","Error"],"sources":["/home/hugo/Documents/4A/cyber/front_url_parser/src/utils/calculateProofOfWork.ts"],"sourcesContent":["export async function calculateProofOfWork(challengeId: string, difficulty: number = 4): Promise<string> {\n  const prefix = '0'.repeat(difficulty);\n  const encoder = new TextEncoder();\n\n  for (let nonce = 0; nonce < Number.MAX_SAFE_INTEGER; nonce++) {\n    const data = encoder.encode(`${challengeId}:${nonce}`);\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", data);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n\n    if (hashHex.startsWith(prefix)) {\n      return nonce.toString();\n    }\n  }\n\n  throw new Error(\"Proof of Work not found.\");\n}\n"],"mappings":"AAAA,OAAO,eAAeA,oBAAoBA,CAACC,WAAmB,EAAEC,UAAkB,GAAG,CAAC,EAAmB;EACvG,MAAMC,MAAM,GAAG,GAAG,CAACC,MAAM,CAACF,UAAU,CAAC;EACrC,MAAMG,OAAO,GAAG,IAAIC,WAAW,CAAC,CAAC;EAEjC,KAAK,IAAIC,KAAK,GAAG,CAAC,EAAEA,KAAK,GAAGC,MAAM,CAACC,gBAAgB,EAAEF,KAAK,EAAE,EAAE;IAC5D,MAAMG,IAAI,GAAGL,OAAO,CAACM,MAAM,CAAC,GAAGV,WAAW,IAAIM,KAAK,EAAE,CAAC;IACtD,MAAMK,UAAU,GAAG,MAAMC,MAAM,CAACC,MAAM,CAACC,MAAM,CAAC,SAAS,EAAEL,IAAI,CAAC;IAC9D,MAAMM,SAAS,GAAGC,KAAK,CAACC,IAAI,CAAC,IAAIC,UAAU,CAACP,UAAU,CAAC,CAAC;IACxD,MAAMQ,OAAO,GAAGJ,SAAS,CAACK,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;IAE5E,IAAIL,OAAO,CAACM,UAAU,CAACvB,MAAM,CAAC,EAAE;MAC9B,OAAOI,KAAK,CAACgB,QAAQ,CAAC,CAAC;IACzB;EACF;EAEA,MAAM,IAAII,KAAK,CAAC,0BAA0B,CAAC;AAC7C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}